<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ÖestVèl EVCI - AS-20260203-0834</title>
    <style>
        :root {
            --ov-purple: #bf00ff;
            --ov-green: #00ff44;
            --panel-bg: #121212;
        }
        body { background: #050505; color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }

        .controller-frame {
            width: 380px;
            background: var(--panel-bg);
            border: 3px solid #333;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 0 50px rgba(0,0,0,1), inset 0 0 10px rgba(255,255,255,0.05);
        }

        /* The High-Intensity Lightbar */
        .lightbar {
            height: 60px;
            background: #000;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 2px solid #222;
        }

        .led { height: 100%; border-radius: 4px; opacity: 0.05; transition: opacity 0.02s; }
        
        /* Left Side: Purple | Right Side: Green */
        .p-led { background: var(--ov-purple); }
        .g-led { background: var(--ov-green); }

        /* Brightness Bloom */
        .p-led.active { opacity: 1; box-shadow: 0 0 40px var(--ov-purple), 0 0 80px var(--ov-purple); background: #fff; }
        .g-led.active { opacity: 1; box-shadow: 0 0 40px var(--ov-green), 0 0 80px var(--ov-green); background: #fff; }

        /* Grid Controls */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .btn {
            padding: 20px 10px;
            background: #222;
            border: 2px solid #444;
            border-radius: 6px;
            color: #777;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: 0.1s;
        }

        .btn.active-run { border-color: var(--ov-purple); color: var(--ov-purple); text-shadow: 0 0 10px var(--ov-purple); }
        .btn.active-siren { border-color: #ff0000; color: #ff0000; animation: pulse 1s infinite; }
        
        @keyframes pulse { 50% { opacity: 0.6; } }

        .status-footer { margin-top: 20px; font-size: 10px; color: #444; text-align: center; font-family: monospace; }
    </style>
</head>
<body>

    <div class="controller-frame">
        <div class="lightbar">
            <div class="led p-led"></div><div class="led p-led"></div><div class="led p-led"></div>
            <div class="led g-led"></div><div class="led g-led"></div><div class="led g-led"></div>
        </div>

        <div class="grid">
            <button class="btn" id="master-btn" onclick="toggleEmergency()">999 Priority</button>
            <button class="btn" id="siren-btn" onclick="toggleSiren()">Siren</button>
            <button class="btn" onclick="allOff()" style="grid-column: span 2; margin-top: 10px; background: #300; color: #f66;">Master Kill</button>
        </div>

        <div class="status-footer">
            SIGNAL ENCRYPTED: AS-20260203-0834<br>
            ÖESTVÈL POLICE - MOBILE UNIT
        </div>
    </div>

    <script>
        let isEmergency = false;
        let isSiren = false;
        const pLeds = document.querySelectorAll('.p-led');
        const gLeds = document.querySelectorAll('.g-led');
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let flashTimer = null;
        let sirenInterval = null;

        async function tripleFlash(side) {
            for(let i=0; i<3; i++) {
                side.forEach(l => l.classList.add('active'));
                await new Promise(r => setTimeout(r, 60));
                side.forEach(l => l.classList.remove('active'));
                await new Promise(r => setTimeout(r, 60));
            }
        }

        async function runPattern() {
            while(isEmergency) {
                // Triple flash Purple (Left)
                await tripleFlash(pLeds);
                await new Promise(r => setTimeout(r, 100));
                // Triple flash Green (Right)
                await tripleFlash(gLeds);
                await new Promise(r => setTimeout(r, 100));
            }
        }

        function toggleEmergency() {
            isEmergency = !isEmergency;
            document.getElementById('master-btn').classList.toggle('active-run');
            if(isEmergency) runPattern();
        }

        function toggleSiren() {
            isSiren = !isSiren;
            document.getElementById('siren-btn').classList.toggle('active-siren');
            if(isSiren) {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sawtooth'; // Rougher, more "ÖestVèl" sound
                osc.connect(gain); gain.connect(audioCtx.destination);
                gain.gain.value = 0.05;
                osc.start();
                
                let t = 0;
                sirenInterval = setInterval(() => {
                    t += 0.1;
                    osc.frequency.setValueAtTime(700 + Math.sin(t * 3) * 300, audioCtx.currentTime);
                }, 50);
                window.currentSiren = osc;
            } else {
                if(window.currentSiren) window.currentSiren.stop();
                clearInterval(sirenInterval);
            }
        }

        function allOff() {
            isEmergency = false;
            isSiren = false;
            document.querySelectorAll('.btn').forEach(b => b.classList.remove('active-run', 'active-siren'));
            if(window.currentSiren) window.currentSiren.stop();
            clearInterval(sirenInterval);
            pLeds.forEach(l => l.classList.remove('active'));
            gLeds.forEach(l => l.classList.remove('active'));
        }
    </script>
</body>
</html>
