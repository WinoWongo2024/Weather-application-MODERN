<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ÖestVèl Emergency Response - AS-20260203-0834</title>
    <style>
        body { background: #0a0a0a; color: white; font-family: 'Helvetica', sans-serif; display: flex; flex-direction: column; align-items: center; height: 100vh; margin: 0; justify-content: center; }
        
        /* Control Panel */
        .console {
            width: 350px;
            background: #1c1c1c;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #333;
            box-shadow: 0 0 30px rgba(0,0,0,1);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .header { grid-column: span 2; text-align: center; border-bottom: 1px solid #444; padding-bottom: 10px; color: #007bff; font-size: 12px; letter-spacing: 1px; }

        /* Buttons */
        .btn {
            height: 60px;
            background: #2a2a2a;
            border: 2px solid #444;
            border-radius: 5px;
            color: #888;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.1s;
            text-align: center;
            font-size: 14px;
        }

        .btn:active { transform: scale(0.95); }
        .btn.active-blue { background: #0056b3; color: white; border-color: #007bff; box-shadow: 0 0 15px rgba(0,123,255,0.5); }
        .btn.active-red { background: #b30000; color: white; border-color: #ff0000; box-shadow: 0 0 15px rgba(255,0,0,0.5); }
        .btn.active-amber { background: #b37400; color: white; border-color: #ffaa00; box-shadow: 0 0 15px rgba(255,170,0,0.5); }

        /* The Visualizer */
        .lightbar-preview {
            grid-column: span 2;
            height: 40px;
            background: #000;
            display: flex;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 10px;
            border: 2px solid #333;
        }

        .led { flex: 1; height: 100%; opacity: 0.1; transition: 0.05s; }
        .led.blue { background: #007bff; }
        .led.red { background: #ff0000; }
        .led.amber { background: #ffaa00; }
        .led.on { opacity: 1; box-shadow: inset 0 0 10px white; }

        .siren-active { animation: blink-text 0.5s infinite; color: #ff0000; }
        @keyframes blink-text { 50% { opacity: 0; } }
    </style>
</head>
<body>

    <div class="console">
        <div class="header">SYSTEM AS-20260203-0834 // ÖESTVÈL POLICE CONTROL</div>

        <div class="lightbar-preview" id="preview">
            <div class="led blue"></div><div class="led blue"></div>
            <div class="led blue"></div><div class="led blue"></div>
            <div class="led red"></div><div class="led red"></div>
            <div class="led blue"></div><div class="led blue"></div>
            <div class="led blue"></div><div class="led blue"></div>
        </div>

        <div class="btn" id="btn-blues" onclick="toggleMode('blues', 'active-blue')">999 BLUES</div>
        <div class="btn" id="btn-rear" onclick="toggleMode('rear', 'active-amber')">REAR AMBER</div>
        <div class="btn" id="btn-wail" onclick="toggleSiren('WAIL')">SIREN WAIL</div>
        <div class="btn" id="btn-yelp" onclick="toggleSiren('YELP')">SIREN YELP</div>
        <div class="btn" id="btn-bull" onclick="playBullhorn()">BULLHORN</div>
        <div class="btn active-red" onclick="allOff()">ALL OFF</div>
    </div>

    <script>
        let modes = { blues: false, rear: false, siren: null };
        const leds = document.querySelectorAll('.led');
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let sirenInterval = null;

        function toggleMode(mode, cssClass) {
            modes[mode] = !modes[mode];
            document.getElementById(`btn-${mode}`).classList.toggle(cssClass);
            if(mode === 'blues') runFlashPattern();
        }

        function runFlashPattern() {
            if(!modes.blues && !modes.rear) {
                leds.forEach(l => l.classList.remove('on'));
                return;
            }

            let step = 0;
            const pattern = setInterval(() => {
                if(!modes.blues && !modes.rear) { clearInterval(pattern); return; }
                
                leds.forEach((l, i) => {
                    l.classList.remove('on');
                    if(modes.blues) {
                        // High-speed Quad Flash pattern
                        if(step < 4 && i < 4) l.classList.add('on');
                        if(step >= 4 && step < 8 && i >= 6) l.classList.add('on');
                    }
                    if(modes.rear && i === 4 || i === 5) {
                        if(step % 2 === 0) l.classList.add('on');
                    }
                });
                step = (step + 1) % 8;
            }, 80);
        }

        function toggleSiren(type) {
            if(modes.siren === type) {
                modes.siren = null;
                stopSiren();
            } else {
                modes.siren = type;
                startSiren(type);
            }
        }

        function startSiren(type) {
            stopSiren();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            gain.gain.value = 0.1;
            
            osc.type = 'triangle';
            osc.start();

            let t = 0;
            sirenInterval = setInterval(() => {
                t += 0.05;
                let freq = (type === 'WAIL') 
                    ? 600 + Math.sin(t * 2) * 200 
                    : 600 + Math.sin(t * 10) * 200;
                osc.frequency.setTargetAtTime(freq, audioCtx.currentTime, 0.05);
            }, 50);
            
            modes.currentOsc = osc;
        }

        function stopSiren() {
            if(modes.currentOsc) {
                modes.currentOsc.stop();
                clearInterval(sirenInterval);
            }
        }

        function playBullhorn() {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.value = 120;
            osc.connect(gain); gain.connect(audioCtx.destination);
            gain.gain.value = 0.2;
            osc.start(); osc.stop(audioCtx.currentTime + 0.3);
        }

        function allOff() {
            modes = { blues: false, rear: false, siren: null };
            document.querySelectorAll('.btn').forEach(b => b.classList.remove('active-blue', 'active-amber'));
            stopSiren();
        }
    </script>
</body>
</html>
